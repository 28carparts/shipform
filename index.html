<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Ship Form</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0; /* Remove default body margin */
            padding: 20px; /* Add some padding around the whole page */
            background-color: #f0f2f5; /* Lighter background */
            color: #333;
            line-height: 1.6;
            min-height: 100vh; /* Ensure body takes full viewport height */
            display: flex; /* Use flexbox for body to center content if needed */
            justify-content: center;
            align-items: flex-start; /* Align content to the top */
            box-sizing: border-box; /* Include padding in height calculation */
        }
        h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.2em; /* Larger heading */
            font-weight: 700;
            width: 100%; /* Ensure heading takes full width in its context */
        }

        /* New main container for horizontal layout */
        .main-container {
            display: flex;
            flex-wrap: wrap; /* Allows wrapping on smaller screens */
            gap: 30px; /* Space between the form and the output section */
            max-width: 1200px; /* Max width for the entire application */
            width: 100%;
            background-color: #ffffff; /* White background for the entire app area */
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            box-sizing: border-box;
        }

        form {
            flex: 1; /* Allows form to grow and shrink */
            min-width: 450px; /* Minimum width for the form column */
            padding: 0; /* Remove padding as it's now on .main-container */
            box-shadow: none; /* Remove shadow as it's on .main-container */
            background-color: transparent; /* Remove background as it's on .main-container */
            border-radius: 0; /* Remove border-radius */
        }

        .form-group {
            margin-bottom: 20px; /* Increased margin for better spacing */
        }
        label {
            display: block;
            margin-bottom: 8px; /* Adjusted margin */
            font-weight: 600;
            color: #4a5568; /* Slightly darker label color */
            font-size: 1.05em;
        }
        input[type="text"], textarea {
            width: 100%;
            padding: 12px 15px; /* Increased padding */
            border: 1px solid #e2e8f0; /* Lighter border */
            border-radius: 8px; /* More rounded inputs */
            font-size: 1em;
            background-color: #f7fafc; /* Slightly off-white background */
            transition: border-color 0.3s, box-shadow 0.3s;
            box-sizing: border-box; /* Include padding in width */
        }
        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #4299e1; /* Blue focus color */
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3); /* Soft blue glow */
        }
        textarea {
            resize: vertical;
            min-height: 100px; /* Minimum height for textarea */
        }
        button {
            padding: 12px 20px; /* Generous padding for buttons */
            margin: 5px; /* Adjusted margin */
            border: none;
            border-radius: 8px; /* Consistent rounded corners */
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 45px; /* Increased min-height for better touch targets */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); /* Subtle button shadow */
        }
        button:hover:not(:disabled) {
            transform: translateY(-3px); /* More pronounced lift on hover */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        .var2, .var3, .var4 {
            background-color: #edf2f7; /* Light grey for unselected buttons */
            color: #4a5568;
        }
        .var2.selected, .var3.selected, .var4.selected {
            background-color: #4299e1; /* Blue for selected buttons */
            color: white;
            box-shadow: 0 4px 10px rgba(66, 153, 225, 0.3); /* Blue shadow for selected */
        }
        #generateButton {
            background-color: #48bb78; /* Green for generate */
            color: white;
            width: calc(50% - 10px); /* Adjust width to fit two buttons per row */
            margin-right: 5px; /* Space between buttons */
            margin-left: 5px;
            font-weight: 600;
        }
        #generateButton:hover {
            background-color: #38a169;
        }
        #clearButton {
            background-color: #ef4444; /* Red for clear */
            color: white;
            width: calc(50% - 10px); /* Adjust width */
            margin-left: 5px; /* Space between buttons */
            margin-right: 5px;
            font-weight: 600;
        }
        #clearButton:hover {
            background-color: #dc2626;
        }

        /* Container for output and copy button */
        .output-section {
            flex: 1; /* Allows output section to grow and shrink */
            min-width: 450px; /* Minimum width for the output column */
            display: flex;
            flex-direction: column; /* Stack output and copy button vertically */
            justify-content: space-between; /* Push output to top, copy to bottom */
        }

        #output {
            padding: 20px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background-color: #f7fafc;
            white-space: pre-wrap;
            font-size: 0.95em;
            line-height: 1.7;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.03); /* Inner shadow for output */
            min-height: 120px; /* Ensure visibility even when empty */
            color: #2d3748; /* Darker text for output */
            flex-grow: 1; /* Allow output to take available vertical space */
            margin-bottom: 20px; /* Space between output and copy button */
        }
        #copyButton {
            background-color: #ed8936; /* Orange for copy */
            color: white;
            padding: 12px 20px;
            width: 100%; /* Full width for copy button within its container */
            margin-top: 0; /* Reset margin-top as controlled by output margin-bottom */
            font-weight: 600;
        }
        #copyButton:disabled {
            background-color: #cbd5e0; /* Lighter grey when disabled */
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        #copyButton:hover:not(:disabled) {
            background-color: #dd6b20;
        }
        .checkbox-label-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .checkbox-label-group label {
            margin-bottom: 0;
            margin-left: 8px; /* Space between checkbox and label */
            font-weight: 500; /* Slightly lighter font for checkbox label */
            color: #4a5568;
        }
        .checkbox-label-group input[type="checkbox"] {
            width: auto;
            margin-right: 0;
            transform: scale(1.2); /* Slightly larger checkbox */
            accent-color: #4299e1; /* Blue checkbox color */
        }
        .flex-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px; /* Increased gap */
            margin-bottom: 20px;
        }
        .flex-container .form-group {
            flex: 1;
            min-width: 250px; /* Adjusted min-width for larger layout */
            margin-bottom: 0;
        }
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px; /* Space between buttons within a group */
            margin-top: 10px;
        }
        .button-group button {
            flex: 1; /* Allow buttons to grow within their group */
            min-width: 120px; /* Minimum width for individual buttons */
            margin: 0; /* Remove individual button margin when in group */
        }

        /* Responsive adjustments */
        @media (max-width: 1024px) { /* Adjust breakpoint for horizontal layout */
            .main-container {
                flex-direction: column; /* Stack columns on smaller screens */
                gap: 20px;
                padding: 25px;
            }
            form, .output-section {
                min-width: unset; /* Remove min-width to allow full width */
                width: 100%;
            }
            #generateButton, #clearButton {
                width: calc(50% - 10px); /* Keep side-by-side if enough space */
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            h2 {
                font-size: 2em;
                margin-bottom: 25px;
            }
            .main-container {
                padding: 20px;
            }
            #generateButton, #clearButton {
                width: 100%; /* Stack buttons on smaller screens */
                margin: 5px 0; /* Adjust margin for stacking */
            }
            .flex-container .form-group {
                min-width: 100%; /* Stack form groups on smaller screens */
            }
            .button-group button {
                min-width: 100px; /* Allow buttons to be smaller on mobile */
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            h2 {
                font-size: 1.8em;
                margin-bottom: 20px;
            }
            .main-container {
                padding: 15px;
            }
            button {
                padding: 10px 15px;
                min-height: 40px;
                font-size: 0.95em;
            }
            #output {
                padding: 15px;
                font-size: 0.9em;
            }
        }

        /* Custom message box styling (improved) */
        #customMessageBox {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #2d3748; /* Darker background */
            color: white;
            padding: 18px 30px;
            border-radius: 10px; /* More rounded */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3); /* Stronger shadow */
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out; /* Added transform transition */
            font-size: 1.1em;
            font-weight: 500;
            text-align: center;
            min-width: 250px;
        }
        #customMessageBox.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1); /* Scale up slightly on show */
        }

    </style>
</head>
<body>
    <div class="main-container">
        <h2>Email Ship Form</h2>
        <form id="orderForm">
            <div class="form-group">
                <div class="checkbox-label-group">
                    <input type="checkbox" id="enableDateField" checked>
                    <label for="enableDateField">Date (DD MMYYYY):</label>
                </div>
                <input type="text" id="dateField">
            </div>
            <div class="form-group">
                <label for="formNumber">SF Form Number:</label>
                <input type="text" id="formNumber" placeholder="Enter SF form number">
            </div>

            <div class="flex-container">
                <div class="form-group">
                    <label>Ship Method:</label>
                    <div class="button-group">
                        <button type="button" class="var2" data-value="寄付">寄付</button>
                        <button type="button" class="var2" data-value="到付">到付</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Sender:</label>
                    <div class="button-group">
                        <button type="button" class="var3" data-value="我">我</button>
                        <button type="button" class="var3" data-value="TSC">TSC</button>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Shipping Option:</label>
                <div class="button-group">
                    <button type="button" class="var4" data-value="店到店優惠">店到店優惠</button>
                    <button type="button" class="var4" data-value="店到門優惠">店到門優惠</button>
                    <button type="button" class="var4" data-value="E-Comm Box">E-Comm Box</button>
                </div>
            </div>
            <div class="form-group">
                <div class="checkbox-label-group">
                    <input type="checkbox" id="enableNotesField" checked>
                    <label for="enableNotesField">Order Items:</label>
                </div>
                <textarea id="notes" rows="4" placeholder="Enter order items"></textarea>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                <button type="button" id="generateButton" onclick="generateMessage()">Generate Message</button>
                <button type="button" id="clearButton" onclick="clearForm()">Clear</button>
            </div>
        </form>

        <div class="output-section">
            <div id="output"></div>
            <button id="copyButton" onclick="copyToClipboard()" disabled>Copy to Clipboard</button>
        </div>
    </div>

    <script>
        // Set current date in DD MMMYYYY format
        const dateField = document.getElementById('dateField');
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const today = new Date();
        const day = String(today.getDate()).padStart(2, '0');
        const month = months[today.getMonth()];
        const year = today.getFullYear();
        dateField.value = `${day} ${month} ${year}`;

        // Auto-save and load Form Number
        const formNumberField = document.getElementById('formNumber');
        const savedFormNumber = localStorage.getItem('formNumber');
        if (savedFormNumber) {
            formNumberField.value = savedFormNumber;
        }
        formNumberField.addEventListener('input', function() {
            localStorage.setItem('formNumber', this.value);
        });

        // Button selection logic
        document.querySelectorAll('.var2, .var3, .var4').forEach(button => {
            button.addEventListener('click', function() {
                console.log(`Button clicked: ${this.dataset.value}`); // Added for debugging
                // Remove 'selected' class from all buttons in the same group
                document.querySelectorAll(`.${this.className}`).forEach(btn => btn.classList.remove('selected'));
                // Add 'selected' class to the clicked button
                this.classList.add('selected');
            });
        });

        // Function to set initial default selections for the button groups
        function setDefaultSelections() {
            // Select '寄付' for Ship Method (var2)
            const defaultVar2Button = document.querySelector('.var2[data-value="寄付"]');
            if (defaultVar2Button) {
                defaultVar2Button.classList.add('selected');
            }

            // Select '我' for Sender (var3)
            const defaultVar3Button = document.querySelector('.var3[data-value="我"]');
            if (defaultVar3Button) {
                defaultVar3Button.classList.add('selected');
            }

            // Select '店到店優惠' for Shipping Option (var4)
            const defaultVar4Button = document.querySelector('.var4[data-value="店到店優惠"]');
            if (defaultVar4Button) {
                defaultVar4Button.classList.add('selected');
            }
        }

        // Call setDefaultSelections on page load to ensure initial defaults are set
        document.addEventListener('DOMContentLoaded', setDefaultSelections);


        function generateMessage() {
            // Get checkbox states
            const enableDateField = document.getElementById('enableDateField').checked;
            const enableNotesField = document.getElementById('enableNotesField').checked;

            // Conditionally get values based on checkbox states
            const date = enableDateField ? dateField.value : '';
            const formNumber = document.getElementById('formNumber').value || '[Form Number]';
            const var2 = document.querySelector('.var2.selected')?.dataset.value || '[寄付/到付]';
            const var3 = document.querySelector('.var3.selected')?.dataset.value || '[我/TSC]';
            const var4 = document.querySelector('.var4.selected')?.dataset.value || '[店到店優惠/店到門優惠/E-Comm Box]';
            const notesValue = document.getElementById('notes').value;
            const notes = enableNotesField && notesValue ? notesValue : '';

            // Construct message parts conditionally
            const dateLineText = enableDateField ? `Your 28CarParts Store order confirmation - 入數交易 ${date}` : '';

            // Build the message, adding a newline after the dateLineText only if it's not empty
            let message = `${dateLineText}${dateLineText ? '\n\n' : ''}Hi Angle,

Please help to ship, thanks!
- Form #${formNumber} (${var2})
- ${var3}交下來 (${var4})`;

            if (notes) {
                message += `\n\n${notes}`; // Add two newlines if notes are enabled and present
            }


            document.getElementById('output').textContent = message;
            document.getElementById('copyButton').disabled = false;
        }

        function clearForm() {
            // Clear all button selections
            document.querySelectorAll('.var2, .var3, .var4').forEach(button => {
                button.classList.remove('selected');
            });
            // Clear Additional Notes
            document.getElementById('notes').value = '';
            // Clear output and disable Copy to Clipboard
            document.getElementById('output').textContent = '';
            document.getElementById('copyButton').disabled = true;
            // Reset checkboxes to checked
            document.getElementById('enableDateField').checked = true;
            document.getElementById('enableNotesField').checked = true;

            // Re-apply default selections after clearing
            setDefaultSelections();
        }

        function copyToClipboard() {
            const output = document.getElementById('output').textContent;
            if (!output) {
                // Using a custom message box instead of alert()
                showMessageBox('Please generate a message first!');
                return;
            }

            if (navigator.clipboard) {
                navigator.clipboard.writeText(output).then(() => {
                    showMessageBox('Message copied to clipboard!');
                }).catch(err => {
                    fallbackCopyText(output);
                });
            } else {
                fallbackCopyText(output);
            }
        }

        function fallbackCopyText(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.opacity = '0';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                document.execCommand('copy');
                showMessageBox('Message copied to clipboard!');
            } catch (err) {
                showMessageBox('Failed to copy: ' + err);
            }
            document.body.removeChild(textArea);
        }

        // Custom message box functions
        function showMessageBox(message) {
            let messageBox = document.getElementById('customMessageBox');
            if (!messageBox) {
                messageBox = document.createElement('div');
                messageBox.id = 'customMessageBox';
                // Styles are now mostly in the CSS block for better maintainability
                document.body.appendChild(messageBox);
            }
            messageBox.textContent = message;
            messageBox.classList.add('show'); // Add 'show' class to trigger transition

            setTimeout(() => {
                messageBox.classList.remove('show'); // Remove 'show' class to hide
            }, 2000); // Hide after 2 seconds
        }
    </script>
</body>
</html>
